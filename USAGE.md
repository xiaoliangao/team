# ä½¿ç”¨æŒ‡å—

## å¿«é€Ÿå¯¼èˆª

1. [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
2. [Webç•Œé¢ä½¿ç”¨](#webç•Œé¢ä½¿ç”¨)
3. [å‘½ä»¤è¡Œä½¿ç”¨](#å‘½ä»¤è¡Œä½¿ç”¨)
4. [å‚æ•°è°ƒä¼˜](#å‚æ•°è°ƒä¼˜)
5. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç¯å¢ƒé…ç½®

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æ£€æŸ¥CUDAï¼ˆå¯é€‰ï¼‰
python -c "import torch; print(f'CUDA: {torch.cuda.is_available()}')"
```

---

## Webç•Œé¢ä½¿ç”¨

### å¯åŠ¨

```bash
python app.py
```

æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€ï¼Œæä¾›ä¸‰ä¸ªåŠŸèƒ½æ ‡ç­¾ï¼š

### ğŸ“¤ é£æ ¼è¿ç§»
1. ä¸Šä¼ å†…å®¹å›¾å’Œé£æ ¼å›¾ï¼ˆæˆ–ä»æœ¬åœ°åº“/WikiArté€‰æ‹©ï¼‰
2. è°ƒæ•´å‚æ•°ï¼šé£æ ¼å¼ºåº¦(1-10)ã€æ­¥æ•°(100-500)ã€å°ºå¯¸(256/512/1024)
3. å¼€å§‹å¤„ç†ï¼Œç­‰å¾…å®Œæˆåä¸‹è½½

### ğŸ¯ é£æ ¼æ¨è
1. ä¸Šä¼ å›¾ç‰‡
2. ç‚¹å‡»åˆ†æï¼Œè·å–Top 5-10æ¨èé£æ ¼
3. é€‰æ‹©æ¨èçš„é£æ ¼è¿›è¡Œè¿ç§»

### ğŸ¬ è§†é¢‘å¤„ç†
1. ä¸Šä¼ è§†é¢‘å’Œé£æ ¼å›¾
2. è®¾ç½®å‚æ•°ï¼ˆå»ºè®®ï¼š256px, 150æ­¥, å¯ç”¨å¸§é—´ä¸€è‡´æ€§ï¼‰
3. å…ˆé™åˆ¶æœ€å¤§å¸§æ•°æµ‹è¯•ï¼ˆå¦‚100å¸§ï¼‰
4. æŸ¥çœ‹è¿›åº¦ï¼Œå®Œæˆåä¸‹è½½

**æ³¨æ„**ï¼šè§†é¢‘å¤„ç†è€—æ—¶é•¿ï¼Œ10ç§’è§†é¢‘çº¦éœ€30-60åˆ†é’Ÿï¼ˆGPUï¼‰

---

## å‘½ä»¤è¡Œä½¿ç”¨

### å›¾åƒé£æ ¼è¿ç§»

#### åŸºæœ¬å‘½ä»¤

```bash
# ä½¿ç”¨æœ¬åœ°å›¾ç‰‡
python train.py --content photo.jpg --style art.jpg

# ä½¿ç”¨WikiArtæ•°æ®é›†
python train.py --content photo.jpg --style-name Impressionism

# æŒ‡å®šè‰ºæœ¯å®¶
python train.py --content photo.jpg --artist "Vincent van Gogh"

# é«˜è´¨é‡è¾“å‡º
python train.py --content photo.jpg --style art.jpg --steps 500 --size 1024
```

### è§†é¢‘é£æ ¼è¿ç§»

#### åŸºæœ¬å‘½ä»¤

```bash
# æœ€ç®€å•çš„ç”¨æ³•ï¼ˆæ–‡ä»¶åœ¨ data/ å¯¹åº”ç›®å½•ä¸­ï¼‰
python video_style_transfer.py my_video.mp4 starry_night.jpg

# ä½¿ç”¨å®Œæ•´è·¯å¾„
python video_style_transfer.py data/content/video.mp4 data/style/style.jpg

# è‡ªå®šä¹‰è¾“å‡ºè·¯å¾„
python video_style_transfer.py video.mp4 style.jpg -o my_output.mp4

# å¿«é€Ÿæµ‹è¯•ï¼ˆåªå¤„ç†å‰50å¸§ï¼‰
python video_style_transfer.py video.mp4 style.jpg -f 50

# é«˜è´¨é‡å¤„ç†
python video_style_transfer.py video.mp4 style.jpg -s 300 --size 1024

# ç¦ç”¨å¸§é—´ä¸€è‡´æ€§ï¼ˆæ›´å¿«ä½†å¯èƒ½é—ªçƒï¼‰
python video_style_transfer.py video.mp4 style.jpg --no-consistency
```

#### è§†é¢‘å¤„ç†å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `video` | è¾“å…¥è§†é¢‘æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰ | - |
| `style` | é£æ ¼å›¾åƒæ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰ | - |
| `-o, --output` | è¾“å‡ºè§†é¢‘è·¯å¾„ | è‡ªåŠ¨ç”Ÿæˆæ—¶é—´æˆ³ |
| `-s, --steps` | ä¼˜åŒ–æ­¥æ•° | 150 |
| `--size` | å¤„ç†å›¾åƒå¤§å° | 512 |
| `-f, --max-frames` | æœ€å¤§å¤„ç†å¸§æ•° | æ— é™åˆ¶ |
| `--style-weight` | é£æ ¼æƒé‡ | 1e6 |
| `--content-weight` | å†…å®¹æƒé‡ | 1.0 |
| `--temporal-weight` | æ—¶é—´ä¸€è‡´æ€§æƒé‡ | 1e4 |
| `--no-consistency` | ç¦ç”¨å¸§é—´ä¸€è‡´æ€§ | False |
| `--device` | è®¡ç®—è®¾å¤‡ | è‡ªåŠ¨æ£€æµ‹ |

#### è§†é¢‘å¤„ç†ç¤ºä¾‹

```bash
# æŸ¥çœ‹å¸®åŠ©
python video_style_transfer.py -h

# å¿«é€Ÿé¢„è§ˆï¼ˆä½åˆ†è¾¨ç‡ï¼Œå°‘é‡å¸§ï¼‰
python video_style_transfer.py video.mp4 style.jpg --size 256 -f 30

# å¹³è¡¡è´¨é‡ï¼ˆæ¨èï¼‰
python video_style_transfer.py video.mp4 style.jpg -s 150 --size 512

# é«˜è´¨é‡è¾“å‡º
python video_style_transfer.py video.mp4 style.jpg -s 300 --size 1024

# è¶…å¿«é€Ÿæµ‹è¯•ï¼ˆæ— ä¸€è‡´æ€§ä¼˜åŒ–ï¼‰
python video_style_transfer.py video.mp4 style.jpg -f 20 --no-consistency

# å®Œæ•´é…ç½®ç¤ºä¾‹
python video_style_transfer.py \
  data/content/my_video.mp4 \
  data/style/starry_night.jpg \
  -o data/outputs/result.mp4 \
  -s 200 \
  --size 768 \
  -f 300 \
  --style-weight 1e6 \
  --temporal-weight 5e3
```

#### è‡ªåŠ¨æ–‡ä»¶å‘½å

å¦‚æœä¸æŒ‡å®šè¾“å‡ºè·¯å¾„ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶åï¼š
```
data/outputs/styled_{è§†é¢‘å}_{é£æ ¼å}_{æ—¶é—´æˆ³}.mp4
```

ä¾‹å¦‚ï¼š
```
data/outputs/styled_my_video_starry_night_20251023_143052.mp4
```

### ä¸»è¦å‚æ•°

#### å›¾åƒå¤„ç†å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--content` | å†…å®¹å›¾ç‰‡è·¯å¾„ | å¿…éœ€ |
| `--style` | é£æ ¼å›¾ç‰‡è·¯å¾„ | None |
| `--style-name` | WikiArté£æ ¼åç§° | None |
| `--steps` | è¿­ä»£æ­¥æ•° | 300 |
| `--style-weight` | é£æ ¼æƒé‡ | 1e6 |
| `--size` | å›¾åƒå°ºå¯¸ | 512 |
| `--output` | è¾“å‡ºç›®å½• | output |

### å›¾ç‰‡åº“ç®¡ç†

```bash
# æŸ¥çœ‹
python manage_styles.py list                    # é£æ ¼å›¾ç‰‡
python manage_styles.py list-content            # å†…å®¹å›¾ç‰‡

# æ·»åŠ 
python manage_styles.py add artwork.jpg
python manage_styles.py add-content photo.jpg

# åˆ é™¤
python manage_styles.py remove old_style.jpg
```

---

## å‚æ•°è°ƒä¼˜

### å›¾åƒå¤„ç†æ¨èé…ç½®

| åœºæ™¯ | æ­¥æ•° | å°ºå¯¸ | é£æ ¼æƒé‡ | è€—æ—¶(GPU) |
|------|------|------|----------|-----------|
| å¿«é€Ÿæµ‹è¯• | 100 | 256 | 1e6 | ~30ç§’ |
| æ—¥å¸¸ä½¿ç”¨ | 200 | 512 | 1e6 | ~1åˆ†é’Ÿ |
| é«˜è´¨é‡ | 300 | 512 | 5e6 | ~2åˆ†é’Ÿ |
| ä¸“ä¸šçº§ | 500 | 1024 | 5e6 | ~5åˆ†é’Ÿ |

### è§†é¢‘å¤„ç†æ¨èé…ç½®

| åœºæ™¯ | æ­¥æ•° | å°ºå¯¸ | å¸§é—´ä¸€è‡´æ€§ | æœ€å¤§å¸§æ•° | é¢„ä¼°æ—¶é—´(GPU) |
|------|------|------|-----------|---------|--------------|
| å¿«é€Ÿé¢„è§ˆ | 100 | 256 | ç¦ç”¨ | 30 | ~5åˆ†é’Ÿ |
| æµ‹è¯•è¿è¡Œ | 150 | 512 | å¯ç”¨ | 100 | ~30åˆ†é’Ÿ |
| æ ‡å‡†è´¨é‡ | 150 | 512 | å¯ç”¨ | æ— é™åˆ¶ | ~2-5å°æ—¶* |
| é«˜è´¨é‡ | 200 | 768 | å¯ç”¨ | æ— é™åˆ¶ | ~5-10å°æ—¶* |
| ä¸“ä¸šçº§ | 300 | 1024 | å¯ç”¨ | æ— é™åˆ¶ | ~10-20å°æ—¶* |

*æ—¶é—´å–å†³äºè§†é¢‘é•¿åº¦å’Œå¸§ç‡ï¼ŒæŒ‰30fpsã€30ç§’è§†é¢‘ä¼°ç®—

### è§†é¢‘å¤„ç†æ—¶é—´ä¼°ç®—

- **256px, 100æ­¥**: æ¯å¸§çº¦3-5ç§’
- **512px, 150æ­¥**: æ¯å¸§çº¦8-12ç§’
- **1024px, 300æ­¥**: æ¯å¸§çº¦30-50ç§’

**ç¤ºä¾‹**ï¼šå¤„ç†ä¸€ä¸ª30ç§’ã€30fpsçš„è§†é¢‘ï¼ˆ900å¸§ï¼‰
- å¿«é€Ÿæ¨¡å¼(256px, 100æ­¥): çº¦1-1.5å°æ—¶
- æ ‡å‡†æ¨¡å¼(512px, 150æ­¥): çº¦2.5-3.5å°æ—¶  
- é«˜è´¨é‡(1024px, 300æ­¥): çº¦8-12å°æ—¶

### å‚æ•°æ•ˆæœ

**é£æ ¼æƒé‡**ï¼š
- `1e5` - å¼±é£æ ¼ï¼Œä¿ç•™æ›´å¤šåŸå›¾
- `1e6` - å¹³è¡¡ï¼ˆæ¨èï¼‰
- `1e7` - å¼ºé£æ ¼ï¼Œè‰ºæœ¯æ„Ÿæ›´å¼º

**è¿­ä»£æ­¥æ•°**ï¼š
- `100` - å¿«é€Ÿé¢„è§ˆ
- `300` - æ ‡å‡†è´¨é‡
- `500` - é«˜è´¨é‡

**å›¾åƒå°ºå¯¸**ï¼š
- `256` - å¿«é€Ÿï¼Œä½å†…å­˜
- `512` - æ¨è
- `1024` - éœ€GPUå’Œå¤§å†…å­˜

---

## å¸¸è§é—®é¢˜

### å›¾åƒå¤„ç†

#### Q1: æ˜¾å­˜ä¸è¶³
```bash
# å‡å°å°ºå¯¸
python train.py --content photo.jpg --style art.jpg --size 256

# ä½¿ç”¨CPU
python train.py --content photo.jpg --style art.jpg --device cpu
```

#### Q2: é£æ ¼å¤ªå¼º/å¤ªå¼±
```bash
# é£æ ¼å¤ªå¼º
python train.py --content photo.jpg --style art.jpg --style-weight 5e5

# é£æ ¼å¤ªå¼±
python train.py --content photo.jpg --style art.jpg --style-weight 5e6
```

#### Q3: å¤„ç†å¤ªæ…¢
```bash
# å‡å°‘æ­¥æ•°å’Œå°ºå¯¸
python train.py --content photo.jpg --style art.jpg --steps 100 --size 256
```

### è§†é¢‘å¤„ç†

#### Q4: è§†é¢‘å¤„ç†ä¸­æ–­æ€ä¹ˆåŠï¼Ÿ
è§†é¢‘å¤„ç†æ”¯æŒ**æ–­ç‚¹ç»­ä¼ **åŠŸèƒ½ï¼š
- æ¯å¤„ç†10å¸§è‡ªåŠ¨ä¿å­˜è¿›åº¦
- é‡æ–°è¿è¡Œç›¸åŒå‘½ä»¤ä¼šä»ä¸Šæ¬¡ä¸­æ–­å¤„ç»§ç»­
- æ£€æŸ¥ç‚¹ä¿å­˜åœ¨ `data/outputs/work_*/checkpoint.json`

```bash
# å¦‚æœä¸­æ–­ï¼Œç›´æ¥é‡æ–°è¿è¡Œç›¸åŒå‘½ä»¤å³å¯ç»§ç»­
python video_style_transfer.py video.mp4 style.jpg -o output.mp4
```

#### Q5: è§†é¢‘å¤„ç†å¤ªæ…¢
```bash
# æ–¹æ³•1: å‡å°åˆ†è¾¨ç‡å’Œæ­¥æ•°
python video_style_transfer.py video.mp4 style.jpg --size 256 -s 100

# æ–¹æ³•2: å…ˆå¤„ç†å°‘é‡å¸§æµ‹è¯•
python video_style_transfer.py video.mp4 style.jpg -f 50

# æ–¹æ³•3: ç¦ç”¨å¸§é—´ä¸€è‡´æ€§ï¼ˆå¿«2-3å€ï¼Œä½†å¯èƒ½é—ªçƒï¼‰
python video_style_transfer.py video.mp4 style.jpg --no-consistency
```

#### Q6: è§†é¢‘è¾“å‡ºæœ‰é—ªçƒ
```bash
# ç¡®ä¿å¯ç”¨å¸§é—´ä¸€è‡´æ€§ï¼ˆé»˜è®¤å¯ç”¨ï¼‰
python video_style_transfer.py video.mp4 style.jpg

# å¢åŠ æ—¶é—´ä¸€è‡´æ€§æƒé‡
python video_style_transfer.py video.mp4 style.jpg --temporal-weight 5e4
```

#### Q7: æ‰¾ä¸åˆ°è§†é¢‘æˆ–é£æ ¼å›¾åƒ
ç¡®ä¿æ–‡ä»¶åœ¨æ­£ç¡®çš„ç›®å½•ä¸­ï¼š
```bash
# è§†é¢‘æ”¾åœ¨è¿™é‡Œ
data/content/your_video.mp4

# é£æ ¼å›¾åƒæ”¾åœ¨è¿™é‡Œ
data/style/your_style.jpg

# ç„¶åä½¿ç”¨æ–‡ä»¶åå³å¯
python video_style_transfer.py your_video.mp4 your_style.jpg
```

æˆ–ä½¿ç”¨å®Œæ•´è·¯å¾„ï¼š
```bash
python video_style_transfer.py /path/to/video.mp4 /path/to/style.jpg
```

#### Q8: å¦‚ä½•ä¼°ç®—å¤„ç†æ—¶é—´ï¼Ÿ
è¿è¡Œè„šæœ¬åä¼šæ˜¾ç¤ºæ¯å¸§å¤„ç†æ—¶é—´å’Œé¢„è®¡å‰©ä½™æ—¶é—´ï¼š
```
å¸§ 10/300 å®Œæˆ (3.3%) - è€—æ—¶: 8.5s - é¢„è®¡å‰©ä½™: 41.2åˆ†é’Ÿ
```

å»ºè®®å…ˆç”¨ `-f 10` å¤„ç†10å¸§æµ‹è¯•ï¼Œæ ¹æ®è€—æ—¶ä¼°ç®—æ€»æ—¶é—´ã€‚

### é€šç”¨é—®é¢˜

#### Q9: GUIæ‰“ä¸å¼€
```bash
pip install gradio
python app.py
# æ‰‹åŠ¨è®¿é—®ï¼šhttp://127.0.0.1:7860
```

---

## å·¥ä½œæµç¨‹

### æ–°æ‰‹å…¥é—¨

#### å›¾åƒé£æ ¼è¿ç§»
1. `pip install -r requirements.txt`
2. `python app.py`
3. ä¸Šä¼ å›¾ç‰‡ï¼Œä½¿ç”¨é»˜è®¤å‚æ•°
4. ä¸‹è½½ç»“æœ

#### è§†é¢‘é£æ ¼è¿ç§»ï¼ˆå‘½ä»¤è¡Œï¼‰
1. å‡†å¤‡è§†é¢‘æ–‡ä»¶ï¼Œæ”¾åœ¨ `data/content/` ç›®å½•
2. å‡†å¤‡é£æ ¼å›¾åƒï¼Œæ”¾åœ¨ `data/style/` ç›®å½•
3. å¿«é€Ÿæµ‹è¯•ï¼š
   ```bash
   python video_style_transfer.py your_video.mp4 style.jpg -f 30
   ```
4. æ»¡æ„åå¤„ç†å®Œæ•´è§†é¢‘ï¼š
   ```bash
   python video_style_transfer.py your_video.mp4 style.jpg
   ```

### è¿›é˜¶ä½¿ç”¨

#### å›¾åƒæ‰¹é‡å¤„ç†
1. å‡†å¤‡å›¾ç‰‡åº“ï¼ˆ`data/content/`, `data/style/`ï¼‰
2. æ‰¹é‡å¤„ç†ï¼š`python batch_process.py --mode folder`
3. å‚æ•°å®éªŒï¼šå°è¯•ä¸åŒé…ç½®
4. æ•´ç†ç»“æœ

#### è§†é¢‘å¤„ç†æœ€ä½³å®è·µ
1. **ç¬¬ä¸€æ­¥ï¼šå¿«é€Ÿé¢„è§ˆ**
   ```bash
   # å¤„ç†å‰30å¸§ï¼Œä½åˆ†è¾¨ç‡
   python video_style_transfer.py video.mp4 style.jpg --size 256 -f 30
   ```

2. **ç¬¬äºŒæ­¥ï¼šå‚æ•°è°ƒä¼˜**
   - æŸ¥çœ‹é¢„è§ˆæ•ˆæœ
   - æ ¹æ®éœ€è¦è°ƒæ•´é£æ ¼æƒé‡ã€æ­¥æ•°ç­‰å‚æ•°
   - å†æ¬¡æµ‹è¯•å°‘é‡å¸§

3. **ç¬¬ä¸‰æ­¥ï¼šå®Œæ•´å¤„ç†**
   ```bash
   # ä½¿ç”¨ä¼˜åŒ–åçš„å‚æ•°å¤„ç†å®Œæ•´è§†é¢‘
   python video_style_transfer.py video.mp4 style.jpg -s 150 --size 512
   ```

4. **ç¬¬å››æ­¥ï¼šç®¡ç†è¾“å‡º**
   - è¾“å‡ºä¿å­˜åœ¨ `data/outputs/`
   - è‡ªåŠ¨ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶å
   - å¯ä»¥æ‰‹åŠ¨æŒ‡å®šè¾“å‡ºåç§°

### ç›®å½•ç»“æ„

```
project/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ content/          # æ”¾ç½®å†…å®¹å›¾åƒå’Œè§†é¢‘
â”‚   â”œâ”€â”€ style/            # æ”¾ç½®é£æ ¼å›¾åƒ
â”‚   â””â”€â”€ outputs/          # å¤„ç†ç»“æœè¾“å‡º
â”‚       â””â”€â”€ work_*/       # è§†é¢‘å¤„ç†å·¥ä½œç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”œâ”€â”€ train.py              # å›¾åƒé£æ ¼è¿ç§»å‘½ä»¤è¡Œ
â”œâ”€â”€ video_style_transfer.py  # è§†é¢‘é£æ ¼è¿ç§»å‘½ä»¤è¡Œ
â””â”€â”€ app.py               # Webç•Œé¢
```

---

**äº«å—åˆ›ä½œï¼** ğŸ¨